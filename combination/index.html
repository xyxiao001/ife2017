<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>组合模式</title>
  </head>
  <body>
    <button id="button">按我</button>
    <pre>
      var button = document.querySelector('#button')

      var MacroCommand = function () {
        return {
          commandList: [],
          add: function (command) {
            this.commandList.push(command)
          },
          excute: function () {
            for (var i = 0, command; command = this.commandList[i++];) {
              command.excute()
            }
          }
        }
      }

      var openAccCommand = {
        excute: function () {
          console.log('打开空调')
        }
      }

      var openTvCommand = {
        excute: function () {
          console.log('打开电视')
        }
      }

      var openSoundCommand = {
        excute: function () {
          console.log('打开音响')
        }
      }

      var macroCommand1 = MacroCommand()
      macroCommand1.add(openTvCommand)
      macroCommand1.add(openSoundCommand)

      var closeDoorCommand = {
        excute: function () {
          console.log('关门')
        }
      }

      var openPcCommand = {
        excute: function () {
          console.log('打开电脑')
        }
      }

      var openQQCommand = {
        excute: function () {
          console.log('登录QQ')
        }
      }

      var macroCommand2 = MacroCommand()
      macroCommand2.add(closeDoorCommand)
      macroCommand2.add(openPcCommand)
      macroCommand2.add(openQQCommand)

      var macroCommand = MacroCommand()
      macroCommand.add(openAccCommand)
      macroCommand.add(macroCommand1)
      macroCommand.add(macroCommand2)

      button.addEventListener('click', function () {
        macroCommand.excute()
      })
    </pre>
    <script type="text/javascript">
      'use strict'
      var button = document.querySelector('#button')

      var MacroCommand = function () {
        return {
          commandList: [],
          add: function (command) {
            this.commandList.push(command)
          },
          excute: function () {
            for (var i = 0, command; command = this.commandList[i++];) {
              command.excute()
            }
          }
        }
      }

      var openAccCommand = {
        excute: function () {
          console.log('打开空调')
        }
      }

      var openTvCommand = {
        excute: function () {
          console.log('打开电视')
        }
      }

      var openSoundCommand = {
        excute: function () {
          console.log('打开音响')
        }
      }

      var macroCommand1 = MacroCommand()
      macroCommand1.add(openTvCommand)
      macroCommand1.add(openSoundCommand)

      var closeDoorCommand = {
        excute: function () {
          console.log('关门')
        }
      }

      var openPcCommand = {
        excute: function () {
          console.log('打开电脑')
        }
      }

      var openQQCommand = {
        excute: function () {
          console.log('登录QQ')
        }
      }

      var macroCommand2 = MacroCommand()
      macroCommand2.add(closeDoorCommand)
      macroCommand2.add(openPcCommand)
      macroCommand2.add(openQQCommand)

      var macroCommand = MacroCommand()
      macroCommand.add(openAccCommand)
      macroCommand.add(macroCommand1)
      macroCommand.add(macroCommand2)

      button.addEventListener('click', function () {
        macroCommand.excute()
      })

      // throw new Error('叶对象不能添加子节点')
    </script>
  </body>
</html>
